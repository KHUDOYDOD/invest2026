"use strict";(()=>{var e={};e.id=8376,e.ids=[8376],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},10136:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{GET:()=>c,POST:()=>d,dynamic:()=>u});var n=r(73278),a=r(45002),o=r(54877),i=r(71309),l=r(86660);let u="force-dynamic";async function c(e){try{let{searchParams:t}=new URL(e.url),r=t.get("email");if(!r)return i.NextResponse.json({error:"Email is required"},{status:400});let s=(0,l.e)();if(!s)return i.NextResponse.json({error:"Database connection failed"},{status:500});let{error:n}=await s.from("user_achievements").select("count").limit(1);if(n&&n.message.includes("does not exist"))return console.log("Achievements table does not exist yet"),i.NextResponse.json({error:"Achievements table does not exist yet"},{status:404});let{data:a,error:o}=await s.from("user_achievements").select("*").eq("user_email",r);if(o)return console.error("Error fetching achievements:",o),i.NextResponse.json({error:"Failed to fetch achievements"},{status:500});let u=a.map(e=>Object.entries(e).reduce((e,[t,r])=>{let s=t.replace(/_([a-z])/g,(e,t)=>t.toUpperCase());return{...e,[s]:r}},{}));return i.NextResponse.json(u)}catch(e){return console.error("Error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e){try{let t;let{userEmail:r,title:s,description:n,icon:a,unlocked:o,progress:u,unlockDate:c}=await e.json();if(!r||!s)return i.NextResponse.json({error:"User email and title are required"},{status:400});let d=(0,l.e)();if(!d)return i.NextResponse.json({error:"Database connection failed"},{status:500});let{error:p}=await d.from("user_achievements").select("count").limit(1);if(p&&p.message.includes("does not exist"))return console.log("Achievements table does not exist yet"),i.NextResponse.json({error:"Achievements table does not exist yet"},{status:404});let{data:m}=await d.from("user_achievements").select("id").eq("user_email",r).eq("title",s).single();if(m){let{data:e,error:r}=await d.from("user_achievements").update({description:n,icon:a,unlocked:o,progress:u,unlock_date:c,updated_at:new Date().toISOString()}).eq("id",m.id).select().single();if(r)return console.error("Error updating achievement:",r),i.NextResponse.json({error:"Failed to update achievement"},{status:500});t=e}else{let{data:e,error:l}=await d.from("user_achievements").insert({user_email:r,title:s,description:n,icon:a,unlocked:o,progress:u,unlock_date:c,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(l)return console.error("Error creating achievement:",l),i.NextResponse.json({error:"Failed to create achievement"},{status:500});t=e}let h=Object.entries(t).reduce((e,[t,r])=>{let s=t.replace(/_([a-z])/g,(e,t)=>t.toUpperCase());return{...e,[s]:r}},{});return i.NextResponse.json(h)}catch(e){return console.error("Error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/achievements/route",pathname:"/api/achievements",filename:"route",bundlePath:"app/api/achievements/route"},resolvedPagePath:"C:\\Users\\x4539\\Downloads\\Invest2025-main\\Invest2025-main\\app\\api\\achievements\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:v}=p,f="/api/achievements/route";function x(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}},86660:(e,t,r)=>{r.d(t,{e:()=>s});function s(){return{auth:{getUser:async()=>({data:{user:null},error:null})},from:()=>({select:()=>({eq:()=>({data:[],error:null}),data:[],error:null}),insert:()=>({data:[],error:null}),update:()=>({data:[],error:null}),delete:()=>({data:[],error:null})})}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7787,4833],()=>r(10136));module.exports=s})();