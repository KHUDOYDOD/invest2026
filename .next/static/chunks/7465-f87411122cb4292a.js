"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7465],{28033:function(e,t,s){s.d(t,{a:function(){return i}});var a=s(57437),r=s(2265),n=s(99376);function i(e){let{children:t}=e,s=(0,n.useRouter)(),[i,c]=(0,r.useState)(!1),[l,d]=(0,r.useState)(!0),[o,u]=(0,r.useState)(null);return((0,r.useEffect)(()=>{(()=>{try{console.log("AuthGuard: Checking authentication...");let e=localStorage.getItem("userEmail"),t=localStorage.getItem("isAuthenticated"),s=localStorage.getItem("authToken"),a=localStorage.getItem("userId");if(console.log("AuthGuard: Checking auth data",{userEmail:e,isAuth:t,hasToken:!!s,userId:a}),!e||!t||!s||!a){console.log("AuthGuard: Missing auth data, redirecting to login"),u("Необходима авторизация"),d(!1),setTimeout(()=>{window.location.href="/login"},1e3);return}console.log("AuthGuard: User authenticated successfully"),c(!0),u(null)}catch(e){console.error("AuthGuard: Auth check error:",e),u("Ошибка проверки авторизации")}finally{d(!1)}})()},[]),l)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-t-blue-500 border-r-transparent border-b-blue-500 border-l-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-white text-lg",children:"Проверка авторизации..."})]})}):o||!i?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"text-red-400 text-xl mb-4",children:o||"Требуется авторизация"}),(0,a.jsx)("button",{onClick:()=>s.push("/login"),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors",children:"Перейти к авторизации"})]})}):(0,a.jsx)(a.Fragment,{children:t})}},79007:function(e,t,s){s.d(t,{R:function(){return p}});var a=s(57437),r=s(2265),n=s(35974),i=s(62869),c=s(71866),l=s(17580),d=s(99397),o=s(91723),u=s(92934),m=s(99388),h=s(82431),x=s(98239);function p(e){let{limit:t=10}=e,[s,p]=(0,r.useState)([]),[f,g]=(0,r.useState)(!0),[w,j]=(0,r.useState)(null);(0,r.useEffect)(()=>{N()},[t]);let N=async()=>{try{g(!0),j(null);let e=localStorage.getItem("authToken"),t=localStorage.getItem("userId");if(!e||!t){j("Токен не найден");return}let s=await fetch("/api/dashboard/all?userId=".concat(t),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),a=await s.json();if(s.ok)p(a.transactions||[]);else{if(401===s.status){localStorage.clear(),window.location.href="/login";return}j(a.error||"Ошибка загрузки транзакций")}}catch(e){console.error("Error fetching transactions:",e),j(e.message||"Ошибка соединения")}finally{g(!1)}},y=e=>{switch(e){case"deposit":return(0,a.jsx)(c.Z,{className:"h-4 w-4"});case"withdrawal":return(0,a.jsx)(l.Z,{className:"h-4 w-4"});case"investment":return(0,a.jsx)(d.Z,{className:"h-4 w-4"});default:return(0,a.jsx)(o.Z,{className:"h-4 w-4"})}},b=e=>{switch(e){case"deposit":return"text-green-400 bg-green-500/20";case"withdrawal":return"text-red-400 bg-red-500/20";case"investment":return"text-blue-400 bg-blue-500/20";default:return"text-gray-400 bg-gray-500/20"}},v=e=>{switch(e.type){case"deposit":return e.description||"Пополнение баланса";case"withdrawal":return e.description||"Вывод средств";case"investment":return e.plan_name?'Инвестиция в "'.concat(e.plan_name,'"'):"Инвестиция";default:return e.description||"Транзакция"}},C=e=>{switch(e.toLowerCase()){case"completed":case"approved":return(0,a.jsx)(u.Z,{className:"h-3 w-3"});case"pending":default:return(0,a.jsx)(o.Z,{className:"h-3 w-3"});case"failed":case"rejected":return(0,a.jsx)(m.Z,{className:"h-3 w-3"})}},k=e=>{switch(e.toLowerCase()){case"completed":case"approved":return"default";case"pending":return"secondary";case"failed":case"rejected":return"destructive";default:return"outline"}},S=e=>{switch(e.toLowerCase()){case"completed":return"✅ Завершена";case"pending":return"⏳ На проверке";case"approved":return"✅ Одобрено";case"rejected":return"❌ Отклонено";case"failed":return"❌ Отклонена";default:return e}};if(f)return(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg animate-pulse",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-white/10 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"w-32 h-4 bg-white/10 rounded"}),(0,a.jsx)("div",{className:"w-20 h-3 bg-white/5 rounded"})]})]}),(0,a.jsx)("div",{className:"w-16 h-4 bg-white/10 rounded"})]},t))});if(w)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-red-400 mb-4",children:w}),(0,a.jsxs)(i.z,{onClick:N,variant:"outline",size:"sm",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Повторить"]})]});if(0===s.length)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(o.Z,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-400 mb-2",children:"У вас пока нет транзакций"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Пополните баланс или сделайте инвестицию, чтобы увидеть историю операций"})]});let Z=t?s.slice(0,t):s;return(0,a.jsxs)("div",{className:"space-y-3",children:[Z.map((e,t)=>(0,a.jsxs)(x.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"flex items-center justify-between p-4 hover:bg-white/5 rounded-lg transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-full ".concat(b(e.type)),children:y(e.type)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white font-medium",children:v(e)}),e.description&&e.description!==v(e)&&(0,a.jsx)("p",{className:"text-white/80 text-sm font-medium",children:e.description}),(0,a.jsx)("p",{className:"text-white/60 text-sm",children:new Date(e.created_at).toLocaleDateString("ru-RU",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}),e.method&&(0,a.jsx)("p",{className:"text-white/40 text-xs",children:"balance"===e.method?"С баланса":"bank_transfer"===e.method?"Банковский перевод":"card"===e.method?"Банковская карта":"crypto"===e.method?"Криптовалюта":e.method})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-semibold ".concat("deposit"===e.type||"profit"===e.type?"text-green-400":"withdrawal"===e.type||"investment"===e.type?"text-red-400":"text-white"),children:["deposit"===e.type||"profit"===e.type?"+":"-","$",Number(e.amount).toFixed(2)]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[C(e.status),(0,a.jsx)(n.C,{variant:k(e.status),className:"text-xs",children:S(e.status)})]})]})})]},e.id)),t&&s.length>t&&(0,a.jsxs)(x.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*Z.length+.2},className:"text-center py-4 border-t border-white/10 mt-4",children:[(0,a.jsxs)("p",{className:"text-white/60 text-sm",children:["И еще ",s.length-t," транзакций..."]}),(0,a.jsx)("p",{className:"text-white/40 text-xs mt-1",children:'Перейдите на страницу "Все транзакции" для просмотра полной истории'})]})]})}},66070:function(e,t,s){s.d(t,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return i},aY:function(){return o},eW:function(){return u},ll:function(){return l}});var a=s(57437),r=s(2265),n=s(94508);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});i.displayName="Card";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});c.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});l.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"}}]);