"use strict";(()=>{var e={};e.id=976,e.ids=[976],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},96391:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{originalPathname:()=>R,patchFetch:()=>c,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var r=a(73278),n=a(45002),o=a(54877),i=a(63614),u=e([i]);i=(u.then?(await u)():u)[0];let p=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/users/balance/route",pathname:"/api/admin/users/balance",filename:"route",bundlePath:"app/api/admin/users/balance/route"},resolvedPagePath:"C:\\Users\\x4539\\Downloads\\Invest2025-main\\Invest2025-main\\app\\api\\admin\\users\\balance\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m}=p,R="/api/admin/users/balance/route";function c(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}s()}catch(e){s(e)}})},63614:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{POST:()=>i});var r=a(71309),n=a(44819),o=e([n]);async function i(e){try{let{userId:t,amount:a}=await e.json();if(!t||!a)return r.NextResponse.json({success:!1,error:"Missing userId or amount"},{status:400});let s=parseFloat(a);if(isNaN(s)||s<=0)return r.NextResponse.json({success:!1,error:"Invalid amount"},{status:400});let o=await (0,n.I)(`UPDATE users 
       SET balance = balance + $1 
       WHERE id = $2 
       RETURNING balance`,[s,t]);if(0===o.rows.length)return r.NextResponse.json({success:!1,error:"User not found"},{status:404});return await (0,n.I)(`INSERT INTO transactions (user_id, type, amount, status, description, created_at)
       VALUES ($1, $2, $3, $4, $5, NOW())`,[t,"deposit",s,"completed","Пополнение баланса администратором"]),r.NextResponse.json({success:!0,newBalance:parseFloat(o.rows[0].balance)})}catch(e){return console.error("Error updating balance:",e),r.NextResponse.json({success:!1,error:"Failed to update balance"},{status:500})}}n=(o.then?(await o)():o)[0],s()}catch(e){s(e)}})},44819:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{I:()=>o});var r=a(8678),n=e([r]);r=(n.then?(await n)():n)[0];let i=process.env.POSTGRES_URL_NON_POOLING||process.env.DATABASE_URL||process.env.POSTGRES_URL;if(!i)throw Error("DATABASE_URL, POSTGRES_URL, or POSTGRES_URL_NON_POOLING must be set. Did you forget to provision a database?");let u=new r.Pool({connectionString:i,ssl:!!i?.includes("sslmode=require")&&{rejectUnauthorized:!1}});async function o(e,t){let a=await u.connect();try{return await a.query(e,t)}finally{a.release()}}s()}catch(e){s(e)}})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[7787,4833],()=>a(96391));module.exports=s})();