<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –°–ë–ü —Å –±–∞–Ω–∫–æ–º</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
        }
        .button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 16px;
            transition: all 0.3s;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
        }
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        .info { border-left: 4px solid #2196F3; }
        h1, h2 { text-align: center; }
        .step {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 3px solid #FFC107;
        }
        .critical {
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid #ff4444;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –°–ë–ü —Å –±–∞–Ω–∫–æ–º</h1>
        <p style="text-align: center; font-size: 18px;">–ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–∞–Ω–∫–∞ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏</p>
        
        <div class="critical">
            <h2>üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û</h2>
            <p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –ë–∞–Ω–∫ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –¥–ª—è –°–ë–ü –∑–∞—è–≤–æ–∫</p>
            <p><strong>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</strong></p>
            <ul>
                <li>‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ—Ç–æ–¥–∞ 'sbp' –≤ –∞–¥–º–∏–Ω API</li>
                <li>‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–∞–Ω–∫–∞ –¥–ª—è –°–ë–ü –≤ API –≤—ã–≤–æ–¥–∞</li>
                <li>‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–∞–Ω–∫–∞ –°–ë–ü</li>
                <li>‚úÖ –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω –∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω</li>
            </ul>
        </div>

        <div class="test-section">
            <h2>üìã –ü–æ—à–∞–≥–æ–≤—ã–π —Ç–µ—Å—Ç</h2>
            
            <div class="step">
                <strong>–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –°–ë–ü –∑–∞—è–≤–∫–∏</strong>
                <button class="button" onclick="openWithdrawPage()">–û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—ã–≤–æ–¥–∞</button>
                <p>1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</p>
                <p>2. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥ "–°–ë–ü"</p>
                <p>3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:</p>
                <ul>
                    <li>–°—É–º–º–∞: 1000</li>
                    <li>–¢–µ–ª–µ—Ñ–æ–Ω: +79123456789</li>
                    <li>–ò–º—è: –¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</li>
                    <li><strong>üè¶ –ë–∞–Ω–∫: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫!</strong></li>
                </ul>
                <p>4. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É</p>
            </div>
            
            <div class="step">
                <strong>–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏</strong>
                <button class="button" onclick="openAdminLogin()">–í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</button>
                <button class="button" onclick="openAdminRequests()">–û—Ç–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫–∏</button>
                <p>–õ–æ–≥–∏–Ω: <code>admin</code>, –ü–∞—Ä–æ–ª—å: <code>X11021997x</code></p>
                <p><strong>–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:</strong></p>
                <ul>
                    <li>–°–ë–ü –∑–∞—è–≤–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã—Ö —Å–µ–∫—Ü–∏—è—Ö</li>
                    <li>–ë–∞–Ω–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å –∏–∫–æ–Ω–∫–æ–π üè¶</li>
                    <li>–ú–µ—Ç–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–°–ë–ü"</li>
                </ul>
            </div>
            
            <div class="step">
                <strong>–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ø—Ä–æ—Å—Ç–æ–π –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏</strong>
                <button class="button" onclick="openAdminRequestsSimple()">–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Å—Ç—É—é –ø–∞–Ω–µ–ª—å</button>
                <p><strong>–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:</strong></p>
                <ul>
                    <li>–°–ë–ü –∑–∞—è–≤–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ</li>
                    <li>–ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∑–∞—è–≤–∫—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</li>
                    <li>–í –¥–µ—Ç–∞–ª—è—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –±–∞–Ω–∫ –¥–ª—è –°–ë–ü</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <h2>üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ API</h2>
            <button class="button" onclick="testAPI()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å API</button>
            <div id="apiResults"></div>
        </div>

        <div class="test-section">
            <h2>‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞</h2>
            <div class="result info">
                <strong>–£—Å–ø–µ—Ö, –µ—Å–ª–∏:</strong>
                <ul>
                    <li>‚úÖ –°–ë–ü –∑–∞—è–≤–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –≤—ã–±–æ—Ä–æ–º –±–∞–Ω–∫–∞</li>
                    <li>‚úÖ –í –æ—Å–Ω–æ–≤–Ω–æ–π –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –±–∞–Ω–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –°–ë–ü</li>
                    <li>‚úÖ –í –ø—Ä–æ—Å—Ç–æ–π –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –±–∞–Ω–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –°–ë–ü</li>
                    <li>‚úÖ –ë–∞–Ω–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å –∏–∫–æ–Ω–∫–æ–π üè¶</li>
                    <li>‚úÖ –ú–µ—Ç–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–°–ë–ü" (–Ω–µ –∫–∞–∫ "sbp")</li>
                </ul>
            </div>
            
            <div class="result error">
                <strong>–ü—Ä–æ–±–ª–µ–º–∞, –µ—Å–ª–∏:</strong>
                <ul>
                    <li>‚ùå –ë–∞–Ω–∫ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –°–ë–ü –∑–∞—è–≤–æ–∫</li>
                    <li>‚ùå –ú–µ—Ç–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ "sbp" –≤–º–µ—Å—Ç–æ "–°–ë–ü"</li>
                    <li>‚ùå –°–ë–ü –∑–∞—è–≤–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã—Ö —Å–µ–∫—Ü–∏—è—Ö</li>
                    <li>‚ùå –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞</li>
                </ul>
            </div>
        </div>

        <div id="testResults"></div>
    </div>

    <script>
        const BASE_URL = 'http://213.171.31.215';
        
        function addResult(message, type = 'info') {
            const results = document.getElementById('apiResults');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = message;
            results.appendChild(div);
        }
        
        async function testAPI() {
            addResult('üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API...', 'info');
            
            try {
                // –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∞
                const adminAuth = await fetch(`${BASE_URL}/api/admin/auth`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username: 'admin',
                        password: 'X11021997x'
                    })
                });
                
                if (adminAuth.ok) {
                    const adminData = await adminAuth.json();
                    addResult('‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞ —É—Å–ø–µ—à–Ω–∞', 'success');
                    
                    // –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞—è–≤–æ–∫ –Ω–∞ –≤—ã–≤–æ–¥
                    const withdrawals = await fetch(`${BASE_URL}/api/admin/withdrawal-requests`, {
                        headers: {
                            'Authorization': `Bearer ${adminData.token}`
                        }
                    });
                    
                    if (withdrawals.ok) {
                        const withdrawalData = await withdrawals.json();
                        addResult('‚úÖ API –∑–∞—è–≤–æ–∫ –Ω–∞ –≤—ã–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                        
                        const sbpRequests = withdrawalData.requests?.filter(req => req.method === '–°–ë–ü' || req.method === 'sbp') || [];
                        addResult(`üì± –ù–∞–π–¥–µ–Ω–æ –°–ë–ü –∑–∞—è–≤–æ–∫: ${sbpRequests.length}`, 'info');
                        
                        if (sbpRequests.length > 0) {
                            const hasBank = sbpRequests.some(req => req.bank_name);
                            if (hasBank) {
                                addResult('‚úÖ –°–ë–ü –∑–∞—è–≤–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–∞–Ω–∫–µ', 'success');
                            } else {
                                addResult('‚ùå –°–ë–ü –∑–∞—è–≤–∫–∏ –ù–ï —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–∞–Ω–∫–µ', 'error');
                            }
                            
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–æ–¥
                            const methodCheck = sbpRequests[0].method;
                            if (methodCheck === '–°–ë–ü') {
                                addResult('‚úÖ –ú–µ—Ç–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–°–ë–ü"', 'success');
                            } else {
                                addResult(`‚ö†Ô∏è –ú–µ—Ç–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "${methodCheck}"`, 'error');
                            }
                        } else {
                            addResult('‚ö†Ô∏è –ù–µ—Ç –°–ë–ü –∑–∞—è–≤–æ–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É.', 'info');
                        }
                    } else {
                        addResult('‚ùå –û—à–∏–±–∫–∞ API –∑–∞—è–≤–æ–∫ –Ω–∞ –≤—ã–≤–æ–¥', 'error');
                    }
                } else {
                    addResult('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∞', 'error');
                }
            } catch (error) {
                addResult('‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ' + error.message, 'error');
            }
        }
        
        function openWithdrawPage() {
            window.open(BASE_URL + '/dashboard/withdraw', '_blank');
        }
        
        function openAdminLogin() {
            window.open(BASE_URL + '/admin/login', '_blank');
        }
        
        function openAdminRequests() {
            window.open(BASE_URL + '/admin/requests', '_blank');
        }
        
        function openAdminRequestsSimple() {
            window.open(BASE_URL + '/admin/requests-simple', '_blank');
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            setTimeout(testAPI, 1000);
        };
    </script>
</body>
</html>