# üß™ –ö–∞–∫ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é –°–∏—Å—Ç–µ–º—É

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –¢–µ—Å—Ç

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –°–µ—Ä–≤–µ—Ä
```bash
npm run dev
```

### –®–∞–≥ 2: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é –°—Å—ã–ª–∫—É

1. –ó–∞–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç: `http://localhost:3000/dashboard`
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª "–†–µ—Ñ–µ—Ä–∞–ª—ã" (–≤ –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é)
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É

–ò–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
node check-referral-fields.js
```

### –®–∞–≥ 3: –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ù–æ–≤–æ–≥–æ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –û—Ç–∫—Ä—ã—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ (–∏–ª–∏ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ)
   - –ü—Ä–∏–º–µ—Ä: `http://localhost:3000/register?ref=REFABC12345`
2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è

### –®–∞–≥ 4: –°–¥–µ–ª–∞—Ç—å –î–µ–ø–æ–∑–∏—Ç

1. –í–æ–π—Ç–∏ –ø–æ–¥ –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ"
3. –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, $1000)

### –®–∞–≥ 5: –û–¥–æ–±—Ä–∏—Ç—å –î–µ–ø–æ–∑–∏—Ç (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)

1. –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ"
3. –û–¥–æ–±—Ä–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ö–æ–º–∏—Å—Å–∏—é

1. –í–æ–π—Ç–∏ –ø–æ–¥ –ø–µ—Ä–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (—Ä–µ—Ñ–µ—Ä–µ—Ä–æ–º)
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–†–µ—Ñ–µ—Ä–∞–ª—ã"
3. –£–≤–∏–¥–µ—Ç—å:
   - –í—Å–µ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤: 1
   - –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: $50 (5% –æ—Ç $1000)
   - –ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ: $1000

4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –≤ —à–∞–ø–∫–µ - –¥–æ–ª–∂–µ–Ω —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è –Ω–∞ $50

5. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å:
   - –¢–∏–ø: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è
   - –°—É–º–º–∞: $50

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ß–µ—Ä–µ–∑ –ë–∞–∑—É –î–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –°–≤—è–∑–∏
```bash
node test-complete-referral-flow.js
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ—Ñ–µ—Ä–µ—Ä–µ
- –°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
- –î–µ–ø–æ–∑–∏—Ç—ã —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –°–≤–æ–¥–∫—É –ø–æ –∑–∞—Ä–∞–±–æ—Ç–∫—É

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –°—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î
```bash
node check-referral-fields.js
```

–ü–æ–∫–∞–∂–µ—Ç:
- –ö–∞–∫–∏–µ –ø–æ–ª—è –µ—Å—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ users
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏
- –ò—Ö —Ç–µ–∫—É—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫

## üìä –ß—Ç–æ –î–æ–ª–∂–Ω–æ –ü—Ä–æ–∏–∑–æ–π—Ç–∏

### –ü—Ä–∏ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –°—Å—ã–ª–∫–µ
```sql
-- –í —Ç–∞–±–ª–∏—Ü–µ users –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
referred_by = 'REFABC12345'  -- –ö–æ–¥ —Ä–µ—Ñ–µ—Ä–µ—Ä–∞
referral_code = 'REFXYZ789'  -- –°–≤–æ–π –Ω–æ–≤—ã–π –∫–æ–¥
```

### –ü—Ä–∏ –û–¥–æ–±—Ä–µ–Ω–∏–∏ –î–µ–ø–æ–∑–∏—Ç–∞ $1000
```sql
-- –î–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–µ—Ñ–µ—Ä–∞–ª–∞):
balance = balance + 1000

-- –î–ª—è —Ä–µ—Ñ–µ—Ä–µ—Ä–∞:
balance = balance + 50          -- +5% –∫–æ–º–∏—Å—Å–∏—è
total_earned = total_earned + 50

-- –í —Ç–∞–±–ª–∏—Ü–µ transactions:
INSERT INTO transactions (
  user_id = referrer_id,
  type = 'referral_bonus',
  amount = 50,
  description = '–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è (5% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞)'
)
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ù–∞ –°—Ç—Ä–∞–Ω–∏—Ü–µ –†–µ—Ñ–µ—Ä–∞–ª–æ–≤
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö–Ω–æ–ø–∫–∏ —à–∞—Ä–∏–Ω–≥–∞ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –≤–∏–¥–Ω–æ:
  - –ò–º—è –∏ email
  - –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  - –°—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
  - –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è

### –í –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- ‚úÖ –ü–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏
- ‚úÖ –¢–∏–ø: "–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è"
- ‚úÖ –°—É–º–º–∞: 5% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞
- ‚úÖ –°—Ç–∞—Ç—É—Å: "–ó–∞–≤–µ—Ä—à–µ–Ω–æ"

### –í –ë–∞–ª–∞–Ω—Å–µ
- ‚úÖ –ë–∞–ª–∞–Ω—Å —Ä–µ—Ñ–µ—Ä–µ—Ä–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—É–º–º—É –∫–æ–º–∏—Å—Å–∏–∏
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–∏–¥–Ω–æ —Å—Ä–∞–∑—É –≤ —à–∞–ø–∫–µ –¥–∞—à–±–æ—Ä–¥–∞

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–º–∏—Å—Å–∏—è –Ω–µ –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ:
1. –ü–æ–ª–µ `referred_by` –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —É —Ä–µ—Ñ–µ—Ä–∞–ª–∞
2. –î–µ–ø–æ–∑–∏—Ç –æ–¥–æ–±—Ä–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º (—Å—Ç–∞—Ç—É—Å = 'approved')
3. –í –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ—Ç –æ—à–∏–±–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ:
1. –ü–∞—Ä–∞–º–µ—Ç—Ä `ref` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ URL
2. –ö–æ–¥ –≤–∞–ª–∏–¥–Ω—ã–π (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ)
3. API —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `referralCode`

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –ø—É—Å—Ç–∞—è
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ:
1. API endpoint `/api/user/referrals` —Ä–∞–±–æ—Ç–∞–µ—Ç
2. userId –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å–µ
3. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ—Ç –æ—à–∏–±–æ–∫

## üìù –õ–æ–≥–∏ –¥–ª—è –û—Ç–ª–∞–¥–∫–∏

### –í –ö–æ–Ω—Å–æ–ª–∏ –°–µ—Ä–≤–µ—Ä–∞
–ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –¥–µ–ø–æ–∑–∏—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
üí∞ Processing referral commission: 50 for code REFABC12345
‚úÖ Referral commission 50 credited to user xxx-xxx-xxx
```

### –í –ö–æ–Ω—Å–æ–ª–∏ –ë—Ä–∞—É–∑–µ—Ä–∞
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:
```
Fetching: /api/user/referrals?userId=xxx-xxx-xxx
Response: { success: true, referralCode: "...", ... }
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [ ] –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Å—ã–ª–∫–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `referred_by` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ
- [ ] –î–µ–ø–æ–∑–∏—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è
- [ ] –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç
- [ ] –ö–æ–º–∏—Å—Å–∏—è –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –ë–∞–ª–∞–Ω—Å —Ä–µ—Ñ–µ—Ä–µ—Ä–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
- [ ] `total_earned` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è
- [ ] –°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

## üéâ –ì–æ—Ç–æ–≤–æ!

–ï—Å–ª–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã —á–µ–∫–ª–∏—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã - —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ!
