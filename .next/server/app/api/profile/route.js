"use strict";(()=>{var e={};e.id=442,e.ids=[442],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},94161:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>j,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>x,staticGenerationAsyncStorage:()=>m});var o={};t.r(o),t.d(o,{GET:()=>p,POST:()=>c,dynamic:()=>u});var s=t(73278),n=t(45002),a=t(54877),i=t(71309),l=t(86660);let u="force-dynamic";async function p(e){try{let{searchParams:r}=new URL(e.url),t=r.get("email");if(!t)return i.NextResponse.json({error:"Email is required"},{status:400});let o=(0,l.e)();if(!o)return i.NextResponse.json({error:"Database connection failed"},{status:500});let{error:s}=await o.from("user_profiles").select("count").limit(1);if(s&&s.message.includes("does not exist"))return console.log("Profile table does not exist yet"),i.NextResponse.json({error:"Profile table does not exist yet"},{status:404});let{data:n,error:a}=await o.from("user_profiles").select("*").eq("email",t).single();if(a)return console.error("Error fetching profile:",a),i.NextResponse.json({error:"Failed to fetch profile"},{status:500});if(!n)return i.NextResponse.json({error:"Profile not found"},{status:404});let u=Object.entries(n).reduce((e,[r,t])=>{let o=r.replace(/_([a-z])/g,(e,r)=>r.toUpperCase());return{...e,[o]:t}},{}),{data:p,error:c}=await o.from("user_achievements").select("*").eq("user_email",t);c&&console.error("Error fetching achievements:",c);let d=p?p.map(e=>Object.entries(e).reduce((e,[r,t])=>{let o=r.replace(/_([a-z])/g,(e,r)=>r.toUpperCase());return{...e,[o]:t}},{})):[];return i.NextResponse.json({...u,achievements:d})}catch(e){return console.error("Error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function c(e){try{let r;let t=await e.json(),{email:o}=t;if(!o)return i.NextResponse.json({error:"Email is required"},{status:400});let s=(0,l.e)();if(!s)return i.NextResponse.json({error:"Database connection failed"},{status:500});let n=Object.entries(t).reduce((e,[r,t])=>{let o=r.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`);return{...e,[o]:t}},{}),{error:a}=await s.from("user_profiles").select("count").limit(1);if(a&&a.message.includes("does not exist"))return console.log("Profile table does not exist yet"),i.NextResponse.json({error:"Profile table does not exist yet"},{status:404});let{data:u}=await s.from("user_profiles").select("id").eq("email",o).single();if(u){let{data:e,error:t}=await s.from("user_profiles").update({...n,updated_at:new Date().toISOString()}).eq("email",o).select().single();if(t)return console.error("Error updating profile:",t),i.NextResponse.json({error:"Failed to update profile"},{status:500});r=e}else{let{data:e,error:t}=await s.from("user_profiles").insert({...n,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(t)return console.error("Error creating profile:",t),i.NextResponse.json({error:"Failed to create profile"},{status:500});r=e}let p=Object.entries(r).reduce((e,[r,t])=>{let o=r.replace(/_([a-z])/g,(e,r)=>r.toUpperCase());return{...e,[o]:t}},{});return i.NextResponse.json(p)}catch(e){return console.error("Error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/profile/route",pathname:"/api/profile",filename:"route",bundlePath:"app/api/profile/route"},resolvedPagePath:"C:\\Users\\x4539\\Downloads\\Invest2025-main\\Invest2025-main\\app\\api\\profile\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:m,serverHooks:x}=d,g="/api/profile/route";function j(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:m})}},86660:(e,r,t)=>{t.d(r,{e:()=>o});function o(){return{auth:{getUser:async()=>({data:{user:null},error:null})},from:()=>({select:()=>({eq:()=>({data:[],error:null}),data:[],error:null}),insert:()=>({data:[],error:null}),update:()=>({data:[],error:null}),delete:()=>({data:[],error:null})})}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[7787,4833],()=>t(94161));module.exports=o})();